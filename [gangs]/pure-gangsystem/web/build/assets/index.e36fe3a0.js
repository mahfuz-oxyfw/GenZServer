import{u as l,b as m,j as o,r as s,a as G,s as S,F as E,Y as H,a8 as Y,h as Z,k as P,a9 as q}from"./index.4165e3c0.js";const J="_container_1b22i_1",K="_chat_1b22i_13",O="_chatBox_1b22i_37",Q="_addIcon_1b22i_53",U="_form_1b22i_67",W="_input_1b22i_83",X="_newMessage_1b22i_115",ee="_newText_1b22i_147",te="_showImage_1b22i_159",ae="_image_1b22i_189",c={container:J,chat:K,chatBox:O,addIcon:Q,form:U,input:W,newMessage:X,newText:ee,showImage:te,image:ae},ne="_container_1079t_1",se="_textContainer_1079t_25",oe="_name_1079t_39",ce="_message_1079t_49",re="_image_1079t_59",w={container:ne,textContainer:se,name:oe,message:ce,image:re},ie=a=>{const i=l(x=>x.config.theme);return m("div",{className:w.container,style:{background:i.chat.chatboxBackground,padding:a.image?"0.6vw":"0.35vw 1vw",paddingTop:a.image?"0.1vw":"0.35vw"},children:[m("div",{className:w.textContainer,onClick:()=>{},style:{width:a.image?"88%":"100%"},children:[m("h1",{className:w.name,style:{color:i.chat.chatboxText},children:[a.name,":"]}),o("h1",{className:w.message,style:{color:i.boxText},children:a.message})]}),a.image&&o("div",{className:w.image,onClick:()=>{a.setImage(a.image||""),a.openImage()},style:{backgroundImage:`url(${a.image})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}})]})},I=18,me=()=>{const[a,i]=s.exports.useState(""),[x,d]=s.exports.useState([]),[f,L]=s.exports.useState(I),u=l(e=>e.config.theme),p=l(e=>e.config.language),n=l(e=>e.gangChat.chatMessages),g=l(e=>e.gangChat.uniqueId),b=l(e=>e.gangChat.playerName),R=l(e=>e.config.config),[A,T]=s.exports.useState(!1),[C,k]=s.exports.useState(!1),[V,$]=s.exports.useState(!0),[h,y]=s.exports.useState(!1),[M,N]=s.exports.useState(""),r=G(),_=s.exports.useRef(null),B=s.exports.useRef(null);s.exports.useMemo(()=>{n.length!==0&&(d(n.slice(n.length-18,n.length)),setTimeout(()=>{var e;(e=_.current)==null||e.scrollIntoView({behavior:"smooth"})},150))},[]),s.exports.useEffect(()=>{const e=R.chatCooldown;if(e===0){y(!1);return}if(!!h&&h){const t=setInterval(()=>{y(!1)},e*1e3);return()=>{clearInterval(t)}}},[h]),s.exports.useEffect(()=>{if(V){$(!1);return}const e=n[n.length-1];!e||e.uniqueId!==g&&(d(t=>[...t,{name:e.name,message:e.message,uniqueId:e.uniqueId,image:e.image}]),T(!0))},[n]);const j=()=>{var e;n.length!==0&&(d(t=>[...n.slice(n.length-(f+I)>0?n.length-(f+I):0,n.length-f>0?n.length-f:0),...t]),L(t=>t+I),!(f>n.length)&&((e=B.current)==null||e.scrollBy({top:50,behavior:"smooth"})))},z=e=>{e.target.scrollTop===0&&j()},F=e=>{e.preventDefault(),!h&&a!==""&&(d(t=>[...t,{name:b,message:a,uniqueId:g}]),r(q({name:b,message:a,uniqueId:g})),i(""),setTimeout(()=>{var t;(t=_.current)==null||t.scrollIntoView({behavior:"smooth"})},10),y(!0))},D=e=>{const t=e.trim();t!==""&&(d(v=>[...v,{name:b,message:a,uniqueId:g,image:t}]),r(q({name:b,message:a,uniqueId:g,image:t})),i(""),setTimeout(()=>{var v;(v=_.current)==null||v.scrollIntoView({behavior:"smooth"})},10))};return s.exports.useEffect(()=>{if(!C)return;const e=t=>{["Escape"].includes(t.code)&&(r(S(!1)),k(!1),N(""))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[C]),m("div",{className:c.container,onClick:e=>{!e.target||typeof e.target.className!="string"||e.target.className.includes("chat")&&(r(S(!1)),k(!1),N(""))},children:[A&&m("div",{className:c.newMessage,onClick:()=>{var e;(e=_.current)==null||e.scrollIntoView({behavior:"smooth"}),T(!1)},style:{background:u.chat.chatboxBackground},children:[o(E,{icon:H,style:{color:u.red,fontSize:"1vw"}}),o("h1",{className:c.newText,style:{color:u.chat.chatboxText},children:p.newMessage})]}),C&&M!=="''"&&o("div",{className:c.showImage,children:o("img",{src:M,className:c.image})}),m("div",{className:c.chat,onScroll:z,ref:B,children:[x.length>0&&x.map((e,t)=>o(ie,{message:e.message,index:t,name:e.uniqueId===g?p.me:e.name,image:e.image,setImage:N,openImage:()=>{k(!0),r(S(!0))}},t)),o("div",{ref:_})]}),m("div",{className:c.chatBox,children:[o("div",{className:c.addIcon,children:o(E,{icon:Y,style:{color:u.chat.chatboxText,fontSize:"1.1vw"},onClick:()=>{r(Z({showPopup:!0,popupText:p.popup.link,popupType:"input",onSubmit:e=>{D(e),r(P())},onCancel:()=>{r(P())}}))}})}),o("form",{onSubmit:e=>{F(e)},className:c.form,children:o("input",{className:c.input,onChange:e=>{h||i(e.target.value)},style:{background:u.chat.chatboxBackground,color:u.chat.chatboxText},value:a,placeholder:h?p.cooldown:p.message,type:"text"})})]})]})};export{me as default};
